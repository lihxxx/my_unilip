[32m[01/21 21:09:53 UniLIP]: [0mSaving config to debug/config.yaml
[32m[01/21 21:09:53 UniLIP]: [0mConfig:
experiment:
  project: debug
  name: debug
  output_dir: debug
  max_train_examples: 1281167
  save_every: 5000
  eval_every: 5000
  generate_every: 1000
  log_every: 50
  log_grad_norm_every: 500
  resume: true
  init_weight: ''
model:
  name: DC_AE_ViT_Unified
  embed_dim: 32
  patch_size: 14
  mllm_path: /mnt/tidal-alsh01/dataset/zeus/lihongxiang/models/InternVL3-1B
  dc_ae_path: /mnt/tidal-alsh01/dataset/zeus/lihongxiang/models/dc-ae-f32c32-sana-1.1-diffusers
  stage1_ckpt: ''
  freeze_encoder: true
  output_distill_feat: false
  disable_drop_path: false
  use_gradient_checkpoint: false
  vq_model:
    quantize_mode: vae
losses:
  name: ReconstructionLoss_Unified
  discriminator_start: 30000
  quantizer_weight: 1.0
  discriminator_factor: 1.0
  discriminator_weight: 0.1
  perceptual_loss: lpips-convnext_s-1.0-0.1
  perceptual_weight: 1.1
  distill_loss: ''
  distill_weight: 0.0
  reconstruction_loss: l2
  reconstruction_weight: 1.0
  lecam_regularization_weight: 0.001
  kl_weight: 0.0
  logvar_init: 0.0
dataset:
  params:
    train_shards_path_or_url: /mnt/tidal-alsh01/dataset/zeus/lihongxiang/unified_model/VGT/tokenizer/data/dataset/train/imagenet-train-{000000..000320}.tar
    eval_shards_path_or_url: /mnt/tidal-alsh01/dataset/zeus/lihongxiang/unified_model/VGT/tokenizer/data/dataset/val/imagenet-val-{000000..000049}.tar
    num_workers_per_gpu: 12
    dataset_with_class_label: true
    dataset_with_text_label: false
  preprocessing:
    resize_shorter_edge: 224
    crop_size: 224
    random_crop: true
    random_flip: true
    normalize_mean:
    - 0.485
    - 0.456
    - 0.406
    normalize_std:
    - 0.229
    - 0.224
    - 0.225
    imagenet_norm: true
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    discriminator_learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.999
    weight_decay: 0.0001
    use_encoder_lr_scale: false
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 3000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 16
  mixed_precision: bf16
  enable_tf32: true
  enable_wandb: true
  wandb_api_key: 3ed65eb52edcc37a5e278a82dd874b44d4ffadb7
  ddp_find_unused_parameters: false
  use_ema: true
  seed: 42
  max_train_steps: 100000
  num_generated_images: 8
  max_grad_norm: 1.0
config: ./configs/training/InternVL3_1B_DCAE/internvl3_1B_unified_stage1_imagenet.yaml

[32m[01/21 21:09:53 UniLIP]: [0mCreating model and loss module.
`torch_dtype` is deprecated! Use `dtype` instead!
Trainable: down_blocks.0.mlp.0.weight
Trainable: down_blocks.0.mlp.0.bias
Trainable: down_blocks.0.mlp.1.weight
Trainable: down_blocks.0.mlp.1.bias
Trainable: down_blocks.0.mlp.3.weight
Trainable: down_blocks.0.mlp.3.bias
Trainable: down_blocks.1.mlp.0.weight
Trainable: down_blocks.1.mlp.0.bias
Trainable: down_blocks.1.mlp.1.weight
Trainable: down_blocks.1.mlp.1.bias
Trainable: down_blocks.1.mlp.3.weight
Trainable: down_blocks.1.mlp.3.bias
Trainable: down_blocks.2.mlp.0.weight
Trainable: down_blocks.2.mlp.0.bias
Trainable: down_blocks.2.mlp.1.weight
Trainable: down_blocks.2.mlp.1.bias
Trainable: down_blocks.2.mlp.3.weight
Trainable: down_blocks.2.mlp.3.bias
Trainable: down_mlp.0.weight
Trainable: down_mlp.0.bias
Trainable: down_mlp.1.weight
Trainable: down_mlp.1.bias
Trainable: down_mlp.3.weight
Trainable: down_mlp.3.bias
Trainable: decoder.conv_in.weight
Trainable: decoder.conv_in.bias
Trainable: decoder.up_blocks.0.0.conv.weight
Trainable: decoder.up_blocks.0.0.conv.bias
Trainable: decoder.up_blocks.0.1.conv1.weight
Trainable: decoder.up_blocks.0.1.conv1.bias
Trainable: decoder.up_blocks.0.1.conv2.weight
Trainable: decoder.up_blocks.0.1.norm.weight
Trainable: decoder.up_blocks.0.1.norm.bias
Trainable: decoder.up_blocks.0.2.conv1.weight
Trainable: decoder.up_blocks.0.2.conv1.bias
Trainable: decoder.up_blocks.0.2.conv2.weight
Trainable: decoder.up_blocks.0.2.norm.weight
Trainable: decoder.up_blocks.0.2.norm.bias
Trainable: decoder.up_blocks.0.3.conv1.weight
Trainable: decoder.up_blocks.0.3.conv1.bias
Trainable: decoder.up_blocks.0.3.conv2.weight
Trainable: decoder.up_blocks.0.3.norm.weight
Trainable: decoder.up_blocks.0.3.norm.bias
Trainable: decoder.up_blocks.1.0.conv.weight
Trainable: decoder.up_blocks.1.0.conv.bias
Trainable: decoder.up_blocks.1.1.conv1.weight
Trainable: decoder.up_blocks.1.1.conv1.bias
Trainable: decoder.up_blocks.1.1.conv2.weight
Trainable: decoder.up_blocks.1.1.norm.weight
Trainable: decoder.up_blocks.1.1.norm.bias
Trainable: decoder.up_blocks.1.2.conv1.weight
Trainable: decoder.up_blocks.1.2.conv1.bias
Trainable: decoder.up_blocks.1.2.conv2.weight
Trainable: decoder.up_blocks.1.2.norm.weight
Trainable: decoder.up_blocks.1.2.norm.bias
Trainable: decoder.up_blocks.1.3.conv1.weight
Trainable: decoder.up_blocks.1.3.conv1.bias
Trainable: decoder.up_blocks.1.3.conv2.weight
Trainable: decoder.up_blocks.1.3.norm.weight
Trainable: decoder.up_blocks.1.3.norm.bias
Trainable: decoder.up_blocks.2.0.conv.weight
Trainable: decoder.up_blocks.2.0.conv.bias
Trainable: decoder.up_blocks.2.1.conv1.weight
Trainable: decoder.up_blocks.2.1.conv1.bias
Trainable: decoder.up_blocks.2.1.conv2.weight
Trainable: decoder.up_blocks.2.1.norm.weight
Trainable: decoder.up_blocks.2.1.norm.bias
Trainable: decoder.up_blocks.2.2.conv1.weight
Trainable: decoder.up_blocks.2.2.conv1.bias
Trainable: decoder.up_blocks.2.2.conv2.weight
Trainable: decoder.up_blocks.2.2.norm.weight
Trainable: decoder.up_blocks.2.2.norm.bias
Trainable: decoder.up_blocks.2.3.conv1.weight
Trainable: decoder.up_blocks.2.3.conv1.bias
Trainable: decoder.up_blocks.2.3.conv2.weight
Trainable: decoder.up_blocks.2.3.norm.weight
Trainable: decoder.up_blocks.2.3.norm.bias
Trainable: decoder.up_blocks.3.0.conv.weight
Trainable: decoder.up_blocks.3.0.conv.bias
Trainable: decoder.up_blocks.3.1.attn.to_q.weight
Trainable: decoder.up_blocks.3.1.attn.to_k.weight
Trainable: decoder.up_blocks.3.1.attn.to_v.weight
Trainable: decoder.up_blocks.3.1.attn.to_qkv_multiscale.0.proj_in.weight
Trainable: decoder.up_blocks.3.1.attn.to_qkv_multiscale.0.proj_out.weight
Trainable: decoder.up_blocks.3.1.attn.to_out.weight
Trainable: decoder.up_blocks.3.1.attn.norm_out.weight
Trainable: decoder.up_blocks.3.1.attn.norm_out.bias
Trainable: decoder.up_blocks.3.1.conv_out.conv_inverted.weight
Trainable: decoder.up_blocks.3.1.conv_out.conv_inverted.bias
Trainable: decoder.up_blocks.3.1.conv_out.conv_depth.weight
Trainable: decoder.up_blocks.3.1.conv_out.conv_depth.bias
Trainable: decoder.up_blocks.3.1.conv_out.conv_point.weight
Trainable: decoder.up_blocks.3.1.conv_out.norm.weight
Trainable: decoder.up_blocks.3.1.conv_out.norm.bias
Trainable: decoder.up_blocks.3.2.attn.to_q.weight
Trainable: decoder.up_blocks.3.2.attn.to_k.weight
Trainable: decoder.up_blocks.3.2.attn.to_v.weight
Trainable: decoder.up_blocks.3.2.attn.to_qkv_multiscale.0.proj_in.weight
Trainable: decoder.up_blocks.3.2.attn.to_qkv_multiscale.0.proj_out.weight
Trainable: decoder.up_blocks.3.2.attn.to_out.weight
Trainable: decoder.up_blocks.3.2.attn.norm_out.weight
Trainable: decoder.up_blocks.3.2.attn.norm_out.bias
Trainable: decoder.up_blocks.3.2.conv_out.conv_inverted.weight
Trainable: decoder.up_blocks.3.2.conv_out.conv_inverted.bias
Trainable: decoder.up_blocks.3.2.conv_out.conv_depth.weight
Trainable: decoder.up_blocks.3.2.conv_out.conv_depth.bias
Trainable: decoder.up_blocks.3.2.conv_out.conv_point.weight
Trainable: decoder.up_blocks.3.2.conv_out.norm.weight
Trainable: decoder.up_blocks.3.2.conv_out.norm.bias
Trainable: decoder.up_blocks.3.3.attn.to_q.weight
Trainable: decoder.up_blocks.3.3.attn.to_k.weight
Trainable: decoder.up_blocks.3.3.attn.to_v.weight
Trainable: decoder.up_blocks.3.3.attn.to_qkv_multiscale.0.proj_in.weight
Trainable: decoder.up_blocks.3.3.attn.to_qkv_multiscale.0.proj_out.weight
Trainable: decoder.up_blocks.3.3.attn.to_out.weight
Trainable: decoder.up_blocks.3.3.attn.norm_out.weight
Trainable: decoder.up_blocks.3.3.attn.norm_out.bias
Trainable: decoder.up_blocks.3.3.conv_out.conv_inverted.weight
Trainable: decoder.up_blocks.3.3.conv_out.conv_inverted.bias
Trainable: decoder.up_blocks.3.3.conv_out.conv_depth.weight
Trainable: decoder.up_blocks.3.3.conv_out.conv_depth.bias
Trainable: decoder.up_blocks.3.3.conv_out.conv_point.weight
Trainable: decoder.up_blocks.3.3.conv_out.norm.weight
Trainable: decoder.up_blocks.3.3.conv_out.norm.bias
Trainable: decoder.up_blocks.4.0.conv.weight
Trainable: decoder.up_blocks.4.0.conv.bias
Trainable: decoder.up_blocks.4.1.attn.to_q.weight
Trainable: decoder.up_blocks.4.1.attn.to_k.weight
Trainable: decoder.up_blocks.4.1.attn.to_v.weight
Trainable: decoder.up_blocks.4.1.attn.to_qkv_multiscale.0.proj_in.weight
Trainable: decoder.up_blocks.4.1.attn.to_qkv_multiscale.0.proj_out.weight
Trainable: decoder.up_blocks.4.1.attn.to_out.weight
Trainable: decoder.up_blocks.4.1.attn.norm_out.weight
Trainable: decoder.up_blocks.4.1.attn.norm_out.bias
Trainable: decoder.up_blocks.4.1.conv_out.conv_inverted.weight
Trainable: decoder.up_blocks.4.1.conv_out.conv_inverted.bias
Trainable: decoder.up_blocks.4.1.conv_out.conv_depth.weight
Trainable: decoder.up_blocks.4.1.conv_out.conv_depth.bias
Trainable: decoder.up_blocks.4.1.conv_out.conv_point.weight
Trainable: decoder.up_blocks.4.1.conv_out.norm.weight
Trainable: decoder.up_blocks.4.1.conv_out.norm.bias
Trainable: decoder.up_blocks.4.2.attn.to_q.weight
Trainable: decoder.up_blocks.4.2.attn.to_k.weight
Trainable: decoder.up_blocks.4.2.attn.to_v.weight
Trainable: decoder.up_blocks.4.2.attn.to_qkv_multiscale.0.proj_in.weight
Trainable: decoder.up_blocks.4.2.attn.to_qkv_multiscale.0.proj_out.weight
Trainable: decoder.up_blocks.4.2.attn.to_out.weight
Trainable: decoder.up_blocks.4.2.attn.norm_out.weight
Trainable: decoder.up_blocks.4.2.attn.norm_out.bias
Trainable: decoder.up_blocks.4.2.conv_out.conv_inverted.weight
Trainable: decoder.up_blocks.4.2.conv_out.conv_inverted.bias
Trainable: decoder.up_blocks.4.2.conv_out.conv_depth.weight
Trainable: decoder.up_blocks.4.2.conv_out.conv_depth.bias
Trainable: decoder.up_blocks.4.2.conv_out.conv_point.weight
Trainable: decoder.up_blocks.4.2.conv_out.norm.weight
Trainable: decoder.up_blocks.4.2.conv_out.norm.bias
Trainable: decoder.up_blocks.4.3.attn.to_q.weight
Trainable: decoder.up_blocks.4.3.attn.to_k.weight
Trainable: decoder.up_blocks.4.3.attn.to_v.weight
Trainable: decoder.up_blocks.4.3.attn.to_qkv_multiscale.0.proj_in.weight
Trainable: decoder.up_blocks.4.3.attn.to_qkv_multiscale.0.proj_out.weight
Trainable: decoder.up_blocks.4.3.attn.to_out.weight
Trainable: decoder.up_blocks.4.3.attn.norm_out.weight
Trainable: decoder.up_blocks.4.3.attn.norm_out.bias
Trainable: decoder.up_blocks.4.3.conv_out.conv_inverted.weight
Trainable: decoder.up_blocks.4.3.conv_out.conv_inverted.bias
Trainable: decoder.up_blocks.4.3.conv_out.conv_depth.weight
Trainable: decoder.up_blocks.4.3.conv_out.conv_depth.bias
Trainable: decoder.up_blocks.4.3.conv_out.conv_point.weight
Trainable: decoder.up_blocks.4.3.conv_out.norm.weight
Trainable: decoder.up_blocks.4.3.conv_out.norm.bias
Trainable: decoder.up_blocks.5.0.attn.to_q.weight
Trainable: decoder.up_blocks.5.0.attn.to_k.weight
Trainable: decoder.up_blocks.5.0.attn.to_v.weight
Trainable: decoder.up_blocks.5.0.attn.to_qkv_multiscale.0.proj_in.weight
Trainable: decoder.up_blocks.5.0.attn.to_qkv_multiscale.0.proj_out.weight
Trainable: decoder.up_blocks.5.0.attn.to_out.weight
Trainable: decoder.up_blocks.5.0.attn.norm_out.weight
Trainable: decoder.up_blocks.5.0.attn.norm_out.bias
Trainable: decoder.up_blocks.5.0.conv_out.conv_inverted.weight
Trainable: decoder.up_blocks.5.0.conv_out.conv_inverted.bias
Trainable: decoder.up_blocks.5.0.conv_out.conv_depth.weight
Trainable: decoder.up_blocks.5.0.conv_out.conv_depth.bias
Trainable: decoder.up_blocks.5.0.conv_out.conv_point.weight
Trainable: decoder.up_blocks.5.0.conv_out.norm.weight
Trainable: decoder.up_blocks.5.0.conv_out.norm.bias
Trainable: decoder.up_blocks.5.1.attn.to_q.weight
Trainable: decoder.up_blocks.5.1.attn.to_k.weight
Trainable: decoder.up_blocks.5.1.attn.to_v.weight
Trainable: decoder.up_blocks.5.1.attn.to_qkv_multiscale.0.proj_in.weight
Trainable: decoder.up_blocks.5.1.attn.to_qkv_multiscale.0.proj_out.weight
Trainable: decoder.up_blocks.5.1.attn.to_out.weight
Trainable: decoder.up_blocks.5.1.attn.norm_out.weight
Trainable: decoder.up_blocks.5.1.attn.norm_out.bias
Trainable: decoder.up_blocks.5.1.conv_out.conv_inverted.weight
Trainable: decoder.up_blocks.5.1.conv_out.conv_inverted.bias
Trainable: decoder.up_blocks.5.1.conv_out.conv_depth.weight
Trainable: decoder.up_blocks.5.1.conv_out.conv_depth.bias
Trainable: decoder.up_blocks.5.1.conv_out.conv_point.weight
Trainable: decoder.up_blocks.5.1.conv_out.norm.weight
Trainable: decoder.up_blocks.5.1.conv_out.norm.bias
Trainable: decoder.up_blocks.5.2.attn.to_q.weight
Trainable: decoder.up_blocks.5.2.attn.to_k.weight
Trainable: decoder.up_blocks.5.2.attn.to_v.weight
Trainable: decoder.up_blocks.5.2.attn.to_qkv_multiscale.0.proj_in.weight
Trainable: decoder.up_blocks.5.2.attn.to_qkv_multiscale.0.proj_out.weight
Trainable: decoder.up_blocks.5.2.attn.to_out.weight
Trainable: decoder.up_blocks.5.2.attn.norm_out.weight
Trainable: decoder.up_blocks.5.2.attn.norm_out.bias
Trainable: decoder.up_blocks.5.2.conv_out.conv_inverted.weight
Trainable: decoder.up_blocks.5.2.conv_out.conv_inverted.bias
Trainable: decoder.up_blocks.5.2.conv_out.conv_depth.weight
Trainable: decoder.up_blocks.5.2.conv_out.conv_depth.bias
Trainable: decoder.up_blocks.5.2.conv_out.conv_point.weight
Trainable: decoder.up_blocks.5.2.conv_out.norm.weight
Trainable: decoder.up_blocks.5.2.conv_out.norm.bias
Trainable: decoder.norm_out.weight
Trainable: decoder.norm_out.bias
Trainable: decoder.conv_out.weight
Trainable: decoder.conv_out.bias
Downloading: "https://download.pytorch.org/models/vgg16-397923af.pth" to .//models/hub/checkpoints/vgg16-397923af.pth
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 528M/528M [00:10<00:00, 53.9MB/s]
/mnt/tidal-alsh01/dataset/zeus/lihongxiang/unified_model/my_unilip/tokenizer/modeling/modules/lpips.py:88: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(VGG_PATH, map_location=torch.device("cpu")), strict=False)
Downloading: "https://download.pytorch.org/models/convnext_small-0c510722.pth" to .//models/hub/checkpoints/convnext_small-0c510722.pth
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 192M/192M [00:04<00:00, 46.2MB/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 192M/192M [00:04<00:00, 48.2MB/s]
self.loss_weight_lpips, self.loss_weight_convnext: 1.0, 0.1
Distillation loss disabled
=================================================================================================================================================================================================================================
Layer (type:depth-idx)                                                      Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
=================================================================================================================================================================================================================================
DC_AE_ViT_Unified                                                           [1, 3, 224, 224]          [1, 3, 224, 224]          --                             --                   --                        --
â”œâ”€InternVisionModel: 1-1                                                    --                        --                        --                             --                   --                        --
â”‚    â””â”€InternVisionEmbeddings: 2-1                                          [1, 3, 224, 224]          [1, 257, 1024]            1,050,624                   0.22%                   --                        --
â”‚    â”‚    â””â”€Conv2d: 3-1                                                     [1, 3, 224, 224]          [1, 1024, 16, 16]         (603,136)                   0.13%                   [14, 14]                  154,402,816
â”‚    â””â”€InternVisionEncoder: 2-2                                             --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ModuleList: 3-2                                                 --                        --                        --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-1                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-1                                        [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-2                                  [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€Identity: 5-3                                         [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-4                                        [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-5                                        [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€Identity: 5-6                                         [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-2                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-7                                        [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-8                                  [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-9                                         [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-10                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-11                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-12                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-3                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-13                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-14                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-15                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-16                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-17                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-18                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-4                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-19                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-20                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-21                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-22                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-23                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-24                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-5                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-25                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-26                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-27                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-28                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-29                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-30                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-6                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-31                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-32                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-33                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-34                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-35                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-36                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-7                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-37                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-38                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-39                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-40                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-41                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-42                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-8                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-43                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-44                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-45                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-46                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-47                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-48                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-9                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-49                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-50                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-51                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-52                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-53                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-54                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-10                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-55                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-56                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-57                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-58                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-59                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-60                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-11                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-61                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-62                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-63                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-64                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-65                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-66                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-12                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-67                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-68                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-69                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-70                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-71                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-72                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-13                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-73                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-74                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-75                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-76                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-77                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-78                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-14                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-79                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-80                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-81                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-82                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-83                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-84                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-15                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-85                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-86                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-87                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-88                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-89                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-90                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-16                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-91                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-92                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-93                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-94                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-95                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-96                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-17                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-97                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-98                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-99                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-100                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-101                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-102                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-18                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-103                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-104                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-105                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-106                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-107                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-108                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-19                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-109                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-110                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-111                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-112                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-113                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-114                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-20                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-115                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-116                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-117                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-118                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-119                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-120                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-21                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-121                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-122                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-123                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-124                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-125                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-126                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-22                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-127                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-128                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-129                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-130                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-131                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-132                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-23                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-133                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-134                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-135                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-136                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-137                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-138                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-24                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-139                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-140                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-141                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-142                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-143                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-144                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”œâ”€Sequential: 1-2                                                           [1, 64, 4096]             [1, 64, 896]              --                             --                   --                        --
â”‚    â””â”€LayerNorm: 2-3                                                       [1, 64, 4096]             [1, 64, 4096]             (8,192)                     0.00%                   --                        8,192
â”‚    â””â”€Linear: 2-4                                                          [1, 64, 4096]             [1, 64, 896]              (3,670,912)                 0.78%                   --                        3,670,912
â”‚    â””â”€GELU: 2-5                                                            [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â””â”€Linear: 2-6                                                          [1, 64, 896]              [1, 64, 896]              (803,712)                   0.17%                   --                        803,712
â”œâ”€ModuleList: 1-3                                                           --                        --                        --                             --                   --                        --
â”‚    â””â”€ResBlock: 2-7                                                        [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â””â”€Sequential: 3-3                                                 [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-25                                            [1, 64, 896]              [1, 64, 896]              1,792                       0.00%                   --                        1,792
â”‚    â”‚    â”‚    â””â”€Linear: 4-26                                               [1, 64, 896]              [1, 64, 896]              803,712                     0.17%                   --                        803,712
â”‚    â”‚    â”‚    â””â”€GELU: 4-27                                                 [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€Linear: 4-28                                               [1, 64, 896]              [1, 64, 896]              803,712                     0.17%                   --                        803,712
â”‚    â””â”€ResBlock: 2-8                                                        [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â””â”€Sequential: 3-4                                                 [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-29                                            [1, 64, 896]              [1, 64, 896]              1,792                       0.00%                   --                        1,792
â”‚    â”‚    â”‚    â””â”€Linear: 4-30                                               [1, 64, 896]              [1, 64, 896]              803,712                     0.17%                   --                        803,712
â”‚    â”‚    â”‚    â””â”€GELU: 4-31                                                 [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€Linear: 4-32                                               [1, 64, 896]              [1, 64, 896]              803,712                     0.17%                   --                        803,712
â”‚    â””â”€ResBlock: 2-9                                                        [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â””â”€Sequential: 3-5                                                 [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-33                                            [1, 64, 896]              [1, 64, 896]              1,792                       0.00%                   --                        1,792
â”‚    â”‚    â”‚    â””â”€Linear: 4-34                                               [1, 64, 896]              [1, 64, 896]              803,712                     0.17%                   --                        803,712
â”‚    â”‚    â”‚    â””â”€GELU: 4-35                                                 [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€Linear: 4-36                                               [1, 64, 896]              [1, 64, 896]              803,712                     0.17%                   --                        803,712
â”œâ”€Sequential: 1-4                                                           [1, 64, 896]              [1, 64, 32]               --                             --                   --                        --
â”‚    â””â”€LayerNorm: 2-10                                                      [1, 64, 896]              [1, 64, 896]              1,792                       0.00%                   --                        1,792
â”‚    â””â”€Linear: 2-11                                                         [1, 64, 896]              [1, 64, 32]               28,704                      0.01%                   --                        28,704
â”‚    â””â”€GELU: 2-12                                                           [1, 64, 32]               [1, 64, 32]               --                             --                   --                        --
â”‚    â””â”€Linear: 2-13                                                         [1, 64, 32]               [1, 64, 32]               1,056                       0.00%                   --                        1,056
â”œâ”€Decoder: 1-5                                                              [1, 32, 8, 8]             [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â””â”€Conv2d: 2-14                                                         [1, 32, 8, 8]             [1, 1024, 8, 8]           295,936                     0.06%                   [3, 3]                    18,939,904
â”‚    â””â”€ModuleList: 2-15                                                     --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€Sequential: 3-6                                                 [1, 1024, 8, 8]           [1, 1024, 8, 8]           --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-37                                    [1, 1024, 8, 8]           [1, 1024, 8, 8]           --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-145                  [1, 1024, 8, 8]           [1, 1024, 8, 8]           5,420,032                   1.15%                   --                        16,451,584
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-146                                      [1, 1024, 8, 8]           [1, 1024, 8, 8]           12,675,072                  2.68%                   --                        811,075,584
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-38                                    [1, 1024, 8, 8]           [1, 1024, 8, 8]           --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-147                  [1, 1024, 8, 8]           [1, 1024, 8, 8]           5,420,032                   1.15%                   --                        16,451,584
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-148                                      [1, 1024, 8, 8]           [1, 1024, 8, 8]           12,675,072                  2.68%                   --                        811,075,584
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-39                                    [1, 1024, 8, 8]           [1, 1024, 8, 8]           --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-149                  [1, 1024, 8, 8]           [1, 1024, 8, 8]           5,420,032                   1.15%                   --                        16,451,584
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-150                                      [1, 1024, 8, 8]           [1, 1024, 8, 8]           12,675,072                  2.68%                   --                        811,075,584
â”‚    â”‚    â””â”€Sequential: 3-7                                                 [1, 1024, 8, 8]           [1, 1024, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€DCUpBlock2d: 4-40                                          [1, 1024, 8, 8]           [1, 1024, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-151                                         [1, 1024, 16, 16]         [1, 1024, 16, 16]         9,438,208                   2.00%                   [3, 3]                    2,416,181,248
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-41                                    [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-152                  [1, 1024, 16, 16]         [1, 1024, 16, 16]         5,420,032                   1.15%                   --                        50,071,552
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-153                                      [1, 1024, 16, 16]         [1, 1024, 16, 16]         12,675,072                  2.68%                   --                        3,244,296,192
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-42                                    [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-154                  [1, 1024, 16, 16]         [1, 1024, 16, 16]         5,420,032                   1.15%                   --                        50,071,552
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-155                                      [1, 1024, 16, 16]         [1, 1024, 16, 16]         12,675,072                  2.68%                   --                        3,244,296,192
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-43                                    [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-156                  [1, 1024, 16, 16]         [1, 1024, 16, 16]         5,420,032                   1.15%                   --                        50,071,552
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-157                                      [1, 1024, 16, 16]         [1, 1024, 16, 16]         12,675,072                  2.68%                   --                        3,244,296,192
â”‚    â”‚    â””â”€Sequential: 3-8                                                 [1, 1024, 16, 16]         [1, 512, 32, 32]          --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€DCUpBlock2d: 4-44                                          [1, 1024, 16, 16]         [1, 512, 32, 32]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-158                                         [1, 1024, 32, 32]         [1, 512, 32, 32]          4,719,104                   1.00%                   [3, 3]                    4,832,362,496
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-45                                    [1, 512, 32, 32]          [1, 512, 32, 32]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-159                  [1, 512, 32, 32]          [1, 512, 32, 32]          1,399,296                   0.30%                   --                        90,964,992
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-160                                      [1, 512, 32, 32]          [1, 512, 32, 32]          3,191,808                   0.68%                   --                        3,267,363,840
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-46                                    [1, 512, 32, 32]          [1, 512, 32, 32]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-161                  [1, 512, 32, 32]          [1, 512, 32, 32]          1,399,296                   0.30%                   --                        90,964,992
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-162                                      [1, 512, 32, 32]          [1, 512, 32, 32]          3,191,808                   0.68%                   --                        3,267,363,840
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-47                                    [1, 512, 32, 32]          [1, 512, 32, 32]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-163                  [1, 512, 32, 32]          [1, 512, 32, 32]          1,399,296                   0.30%                   --                        90,964,992
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-164                                      [1, 512, 32, 32]          [1, 512, 32, 32]          3,191,808                   0.68%                   --                        3,267,363,840
â”‚    â”‚    â””â”€Sequential: 3-9                                                 [1, 512, 32, 32]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€DCUpBlock2d: 4-48                                          [1, 512, 32, 32]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-165                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,808                   0.50%                   [3, 3]                    9,665,773,568
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-49                                             [1, 512, 64, 64]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-166                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,808                   0.50%                   [3, 3]                    9,665,773,568
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-167                                           [1, 512, 64, 64]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-168                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,296                   0.50%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-169                                        [1, 64, 64, 512]          [1, 64, 64, 512]          1,024                       0.00%                   --                        1,024
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-50                                             [1, 512, 64, 64]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-170                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,808                   0.50%                   [3, 3]                    9,665,773,568
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-171                                           [1, 512, 64, 64]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-172                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,296                   0.50%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-173                                        [1, 64, 64, 512]          [1, 64, 64, 512]          1,024                       0.00%                   --                        1,024
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-51                                             [1, 512, 64, 64]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-174                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,808                   0.50%                   [3, 3]                    9,665,773,568
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-175                                           [1, 512, 64, 64]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-176                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,296                   0.50%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-177                                        [1, 64, 64, 512]          [1, 64, 64, 512]          1,024                       0.00%                   --                        1,024
â”‚    â”‚    â””â”€Sequential: 3-10                                                [1, 512, 64, 64]          [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€DCUpBlock2d: 4-52                                          [1, 512, 64, 64]          [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-178                                         [1, 512, 128, 128]        [1, 256, 128, 128]        1,179,904                   0.25%                   [3, 3]                    19,331,547,136
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-53                                             [1, 256, 128, 128]        [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-179                                         [1, 256, 128, 128]        [1, 256, 128, 128]        590,080                     0.12%                   [3, 3]                    9,667,870,720
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-180                                           [1, 256, 128, 128]        [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-181                                         [1, 256, 128, 128]        [1, 256, 128, 128]        589,824                     0.12%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-182                                        [1, 128, 128, 256]        [1, 128, 128, 256]        512                         0.00%                   --                        512
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-54                                             [1, 256, 128, 128]        [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-183                                         [1, 256, 128, 128]        [1, 256, 128, 128]        590,080                     0.12%                   [3, 3]                    9,667,870,720
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-184                                           [1, 256, 128, 128]        [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-185                                         [1, 256, 128, 128]        [1, 256, 128, 128]        589,824                     0.12%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-186                                        [1, 128, 128, 256]        [1, 128, 128, 256]        512                         0.00%                   --                        512
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-55                                             [1, 256, 128, 128]        [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-187                                         [1, 256, 128, 128]        [1, 256, 128, 128]        590,080                     0.12%                   [3, 3]                    9,667,870,720
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-188                                           [1, 256, 128, 128]        [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-189                                         [1, 256, 128, 128]        [1, 256, 128, 128]        589,824                     0.12%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-190                                        [1, 128, 128, 256]        [1, 128, 128, 256]        512                         0.00%                   --                        512
â”‚    â”‚    â””â”€Sequential: 3-11                                                [1, 256, 128, 128]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€DCUpBlock2d: 4-56                                          [1, 256, 128, 128]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-191                                         [1, 256, 256, 256]        [1, 128, 256, 256]        295,040                     0.06%                   [3, 3]                    19,335,741,440
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-57                                             [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-192                                         [1, 128, 256, 256]        [1, 128, 256, 256]        147,584                     0.03%                   [3, 3]                    9,672,065,024
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-193                                           [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-194                                         [1, 128, 256, 256]        [1, 128, 256, 256]        147,456                     0.03%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-195                                        [1, 256, 256, 128]        [1, 256, 256, 128]        256                         0.00%                   --                        256
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-58                                             [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-196                                         [1, 128, 256, 256]        [1, 128, 256, 256]        147,584                     0.03%                   [3, 3]                    9,672,065,024
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-197                                           [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-198                                         [1, 128, 256, 256]        [1, 128, 256, 256]        147,456                     0.03%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-199                                        [1, 256, 256, 128]        [1, 256, 256, 128]        256                         0.00%                   --                        256
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-59                                             [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-200                                         [1, 128, 256, 256]        [1, 128, 256, 256]        147,584                     0.03%                   [3, 3]                    9,672,065,024
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-201                                           [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-202                                         [1, 128, 256, 256]        [1, 128, 256, 256]        147,456                     0.03%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-203                                        [1, 256, 256, 128]        [1, 256, 256, 128]        256                         0.00%                   --                        256
â”‚    â””â”€RMSNorm: 2-16                                                        [1, 256, 256, 128]        [1, 256, 256, 128]        256                         0.00%                   --                        256
â”‚    â””â”€ReLU: 2-17                                                           [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â””â”€Conv2d: 2-18                                                         [1, 128, 256, 256]        [1, 3, 256, 256]          3,459                       0.00%                   [3, 3]                    226,689,024
=================================================================================================================================================================================================================================
Total params: 472,577,475
Trainable params: 164,082,371
Non-trainable params: 308,495,104
Total mult-adds (G): 252.72
=================================================================================================================================================================================================================================
Input size (MB): 0.60
Forward/backward pass size (MB): 2408.42
Params size (MB): 1885.91
Estimated Total Size (MB): 4294.93
=================================================================================================================================================================================================================================
[32m[01/21 21:10:22 UniLIP]: [0m=================================================================================================================================================================================================================================
Layer (type:depth-idx)                                                      Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
=================================================================================================================================================================================================================================
DC_AE_ViT_Unified                                                           [1, 3, 224, 224]          [1, 3, 224, 224]          --                             --                   --                        --
â”œâ”€InternVisionModel: 1-1                                                    --                        --                        --                             --                   --                        --
â”‚    â””â”€InternVisionEmbeddings: 2-1                                          [1, 3, 224, 224]          [1, 257, 1024]            1,050,624                   0.22%                   --                        --
â”‚    â”‚    â””â”€Conv2d: 3-1                                                     [1, 3, 224, 224]          [1, 1024, 16, 16]         (603,136)                   0.13%                   [14, 14]                  154,402,816
â”‚    â””â”€InternVisionEncoder: 2-2                                             --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ModuleList: 3-2                                                 --                        --                        --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-1                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-1                                        [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-2                                  [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€Identity: 5-3                                         [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-4                                        [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-5                                        [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€Identity: 5-6                                         [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-2                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-7                                        [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-8                                  [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-9                                         [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-10                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-11                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-12                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-3                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-13                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-14                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-15                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-16                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-17                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-18                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-4                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-19                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-20                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-21                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-22                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-23                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-24                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-5                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-25                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-26                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-27                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-28                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-29                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-30                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-6                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-31                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-32                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-33                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-34                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-35                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-36                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-7                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-37                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-38                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-39                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-40                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-41                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-42                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-8                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-43                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-44                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-45                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-46                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-47                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-48                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-9                              [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-49                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-50                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-51                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-52                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-53                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-54                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-10                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-55                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-56                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-57                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-58                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-59                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-60                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-11                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-61                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-62                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-63                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-64                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-65                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-66                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-12                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-67                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-68                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-69                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-70                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-71                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-72                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-13                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-73                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-74                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-75                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-76                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-77                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-78                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-14                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-79                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-80                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-81                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-82                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-83                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-84                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-15                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-85                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-86                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-87                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-88                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-89                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-90                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-16                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-91                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-92                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-93                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-94                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-95                                       [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-96                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-17                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-97                                       [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-98                                 [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-99                                        [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-100                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-101                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-102                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-18                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-103                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-104                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-105                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-106                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-107                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-108                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-19                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-109                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-110                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-111                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-112                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-113                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-114                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-20                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-115                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-116                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-117                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-118                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-119                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-120                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-21                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-121                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-122                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-123                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-124                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-125                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-126                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-22                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-127                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-128                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-129                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-130                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-131                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-132                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-23                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-133                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-134                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-135                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-136                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-137                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-138                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€InternVisionEncoderLayer: 4-24                             [1, 257, 1024]            [1, 257, 1024]            2,048                       0.00%                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-139                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternAttention: 5-140                                [1, 257, 1024]            [1, 257, 1024]            (4,198,400)                 0.89%                   --                        4,198,400
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-141                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€LayerNorm: 5-142                                      [1, 257, 1024]            [1, 257, 1024]            (2,048)                     0.00%                   --                        2,048
â”‚    â”‚    â”‚    â”‚    â””â”€InternMLP: 5-143                                      [1, 257, 1024]            [1, 257, 1024]            (8,393,728)                 1.78%                   --                        8,393,728
â”‚    â”‚    â”‚    â”‚    â””â”€DropPath: 5-144                                       [1, 257, 1024]            [1, 257, 1024]            --                             --                   --                        --
â”œâ”€Sequential: 1-2                                                           [1, 64, 4096]             [1, 64, 896]              --                             --                   --                        --
â”‚    â””â”€LayerNorm: 2-3                                                       [1, 64, 4096]             [1, 64, 4096]             (8,192)                     0.00%                   --                        8,192
â”‚    â””â”€Linear: 2-4                                                          [1, 64, 4096]             [1, 64, 896]              (3,670,912)                 0.78%                   --                        3,670,912
â”‚    â””â”€GELU: 2-5                                                            [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â””â”€Linear: 2-6                                                          [1, 64, 896]              [1, 64, 896]              (803,712)                   0.17%                   --                        803,712
â”œâ”€ModuleList: 1-3                                                           --                        --                        --                             --                   --                        --
â”‚    â””â”€ResBlock: 2-7                                                        [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â””â”€Sequential: 3-3                                                 [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-25                                            [1, 64, 896]              [1, 64, 896]              1,792                       0.00%                   --                        1,792
â”‚    â”‚    â”‚    â””â”€Linear: 4-26                                               [1, 64, 896]              [1, 64, 896]              803,712                     0.17%                   --                        803,712
â”‚    â”‚    â”‚    â””â”€GELU: 4-27                                                 [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€Linear: 4-28                                               [1, 64, 896]              [1, 64, 896]              803,712                     0.17%                   --                        803,712
â”‚    â””â”€ResBlock: 2-8                                                        [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â””â”€Sequential: 3-4                                                 [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-29                                            [1, 64, 896]              [1, 64, 896]              1,792                       0.00%                   --                        1,792
â”‚    â”‚    â”‚    â””â”€Linear: 4-30                                               [1, 64, 896]              [1, 64, 896]              803,712                     0.17%                   --                        803,712
â”‚    â”‚    â”‚    â””â”€GELU: 4-31                                                 [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€Linear: 4-32                                               [1, 64, 896]              [1, 64, 896]              803,712                     0.17%                   --                        803,712
â”‚    â””â”€ResBlock: 2-9                                                        [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â””â”€Sequential: 3-5                                                 [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-33                                            [1, 64, 896]              [1, 64, 896]              1,792                       0.00%                   --                        1,792
â”‚    â”‚    â”‚    â””â”€Linear: 4-34                                               [1, 64, 896]              [1, 64, 896]              803,712                     0.17%                   --                        803,712
â”‚    â”‚    â”‚    â””â”€GELU: 4-35                                                 [1, 64, 896]              [1, 64, 896]              --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€Linear: 4-36                                               [1, 64, 896]              [1, 64, 896]              803,712                     0.17%                   --                        803,712
â”œâ”€Sequential: 1-4                                                           [1, 64, 896]              [1, 64, 32]               --                             --                   --                        --
â”‚    â””â”€LayerNorm: 2-10                                                      [1, 64, 896]              [1, 64, 896]              1,792                       0.00%                   --                        1,792
â”‚    â””â”€Linear: 2-11                                                         [1, 64, 896]              [1, 64, 32]               28,704                      0.01%                   --                        28,704
â”‚    â””â”€GELU: 2-12                                                           [1, 64, 32]               [1, 64, 32]               --                             --                   --                        --
â”‚    â””â”€Linear: 2-13                                                         [1, 64, 32]               [1, 64, 32]               1,056                       0.00%                   --                        1,056
â”œâ”€Decoder: 1-5                                                              [1, 32, 8, 8]             [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â””â”€Conv2d: 2-14                                                         [1, 32, 8, 8]             [1, 1024, 8, 8]           295,936                     0.06%                   [3, 3]                    18,939,904
â”‚    â””â”€ModuleList: 2-15                                                     --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€Sequential: 3-6                                                 [1, 1024, 8, 8]           [1, 1024, 8, 8]           --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-37                                    [1, 1024, 8, 8]           [1, 1024, 8, 8]           --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-145                  [1, 1024, 8, 8]           [1, 1024, 8, 8]           5,420,032                   1.15%                   --                        16,451,584
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-146                                      [1, 1024, 8, 8]           [1, 1024, 8, 8]           12,675,072                  2.68%                   --                        811,075,584
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-38                                    [1, 1024, 8, 8]           [1, 1024, 8, 8]           --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-147                  [1, 1024, 8, 8]           [1, 1024, 8, 8]           5,420,032                   1.15%                   --                        16,451,584
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-148                                      [1, 1024, 8, 8]           [1, 1024, 8, 8]           12,675,072                  2.68%                   --                        811,075,584
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-39                                    [1, 1024, 8, 8]           [1, 1024, 8, 8]           --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-149                  [1, 1024, 8, 8]           [1, 1024, 8, 8]           5,420,032                   1.15%                   --                        16,451,584
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-150                                      [1, 1024, 8, 8]           [1, 1024, 8, 8]           12,675,072                  2.68%                   --                        811,075,584
â”‚    â”‚    â””â”€Sequential: 3-7                                                 [1, 1024, 8, 8]           [1, 1024, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€DCUpBlock2d: 4-40                                          [1, 1024, 8, 8]           [1, 1024, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-151                                         [1, 1024, 16, 16]         [1, 1024, 16, 16]         9,438,208                   2.00%                   [3, 3]                    2,416,181,248
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-41                                    [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-152                  [1, 1024, 16, 16]         [1, 1024, 16, 16]         5,420,032                   1.15%                   --                        50,071,552
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-153                                      [1, 1024, 16, 16]         [1, 1024, 16, 16]         12,675,072                  2.68%                   --                        3,244,296,192
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-42                                    [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-154                  [1, 1024, 16, 16]         [1, 1024, 16, 16]         5,420,032                   1.15%                   --                        50,071,552
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-155                                      [1, 1024, 16, 16]         [1, 1024, 16, 16]         12,675,072                  2.68%                   --                        3,244,296,192
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-43                                    [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-156                  [1, 1024, 16, 16]         [1, 1024, 16, 16]         5,420,032                   1.15%                   --                        50,071,552
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-157                                      [1, 1024, 16, 16]         [1, 1024, 16, 16]         12,675,072                  2.68%                   --                        3,244,296,192
â”‚    â”‚    â””â”€Sequential: 3-8                                                 [1, 1024, 16, 16]         [1, 512, 32, 32]          --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€DCUpBlock2d: 4-44                                          [1, 1024, 16, 16]         [1, 512, 32, 32]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-158                                         [1, 1024, 32, 32]         [1, 512, 32, 32]          4,719,104                   1.00%                   [3, 3]                    4,832,362,496
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-45                                    [1, 512, 32, 32]          [1, 512, 32, 32]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-159                  [1, 512, 32, 32]          [1, 512, 32, 32]          1,399,296                   0.30%                   --                        90,964,992
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-160                                      [1, 512, 32, 32]          [1, 512, 32, 32]          3,191,808                   0.68%                   --                        3,267,363,840
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-46                                    [1, 512, 32, 32]          [1, 512, 32, 32]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-161                  [1, 512, 32, 32]          [1, 512, 32, 32]          1,399,296                   0.30%                   --                        90,964,992
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-162                                      [1, 512, 32, 32]          [1, 512, 32, 32]          3,191,808                   0.68%                   --                        3,267,363,840
â”‚    â”‚    â”‚    â””â”€EfficientViTBlock: 4-47                                    [1, 512, 32, 32]          [1, 512, 32, 32]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€SanaMultiscaleLinearAttention: 5-163                  [1, 512, 32, 32]          [1, 512, 32, 32]          1,399,296                   0.30%                   --                        90,964,992
â”‚    â”‚    â”‚    â”‚    â””â”€GLUMBConv: 5-164                                      [1, 512, 32, 32]          [1, 512, 32, 32]          3,191,808                   0.68%                   --                        3,267,363,840
â”‚    â”‚    â””â”€Sequential: 3-9                                                 [1, 512, 32, 32]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€DCUpBlock2d: 4-48                                          [1, 512, 32, 32]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-165                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,808                   0.50%                   [3, 3]                    9,665,773,568
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-49                                             [1, 512, 64, 64]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-166                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,808                   0.50%                   [3, 3]                    9,665,773,568
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-167                                           [1, 512, 64, 64]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-168                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,296                   0.50%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-169                                        [1, 64, 64, 512]          [1, 64, 64, 512]          1,024                       0.00%                   --                        1,024
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-50                                             [1, 512, 64, 64]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-170                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,808                   0.50%                   [3, 3]                    9,665,773,568
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-171                                           [1, 512, 64, 64]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-172                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,296                   0.50%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-173                                        [1, 64, 64, 512]          [1, 64, 64, 512]          1,024                       0.00%                   --                        1,024
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-51                                             [1, 512, 64, 64]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-174                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,808                   0.50%                   [3, 3]                    9,665,773,568
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-175                                           [1, 512, 64, 64]          [1, 512, 64, 64]          --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-176                                         [1, 512, 64, 64]          [1, 512, 64, 64]          2,359,296                   0.50%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-177                                        [1, 64, 64, 512]          [1, 64, 64, 512]          1,024                       0.00%                   --                        1,024
â”‚    â”‚    â””â”€Sequential: 3-10                                                [1, 512, 64, 64]          [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€DCUpBlock2d: 4-52                                          [1, 512, 64, 64]          [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-178                                         [1, 512, 128, 128]        [1, 256, 128, 128]        1,179,904                   0.25%                   [3, 3]                    19,331,547,136
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-53                                             [1, 256, 128, 128]        [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-179                                         [1, 256, 128, 128]        [1, 256, 128, 128]        590,080                     0.12%                   [3, 3]                    9,667,870,720
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-180                                           [1, 256, 128, 128]        [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-181                                         [1, 256, 128, 128]        [1, 256, 128, 128]        589,824                     0.12%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-182                                        [1, 128, 128, 256]        [1, 128, 128, 256]        512                         0.00%                   --                        512
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-54                                             [1, 256, 128, 128]        [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-183                                         [1, 256, 128, 128]        [1, 256, 128, 128]        590,080                     0.12%                   [3, 3]                    9,667,870,720
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-184                                           [1, 256, 128, 128]        [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-185                                         [1, 256, 128, 128]        [1, 256, 128, 128]        589,824                     0.12%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-186                                        [1, 128, 128, 256]        [1, 128, 128, 256]        512                         0.00%                   --                        512
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-55                                             [1, 256, 128, 128]        [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-187                                         [1, 256, 128, 128]        [1, 256, 128, 128]        590,080                     0.12%                   [3, 3]                    9,667,870,720
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-188                                           [1, 256, 128, 128]        [1, 256, 128, 128]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-189                                         [1, 256, 128, 128]        [1, 256, 128, 128]        589,824                     0.12%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-190                                        [1, 128, 128, 256]        [1, 128, 128, 256]        512                         0.00%                   --                        512
â”‚    â”‚    â””â”€Sequential: 3-11                                                [1, 256, 128, 128]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€DCUpBlock2d: 4-56                                          [1, 256, 128, 128]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-191                                         [1, 256, 256, 256]        [1, 128, 256, 256]        295,040                     0.06%                   [3, 3]                    19,335,741,440
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-57                                             [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-192                                         [1, 128, 256, 256]        [1, 128, 256, 256]        147,584                     0.03%                   [3, 3]                    9,672,065,024
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-193                                           [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-194                                         [1, 128, 256, 256]        [1, 128, 256, 256]        147,456                     0.03%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-195                                        [1, 256, 256, 128]        [1, 256, 256, 128]        256                         0.00%                   --                        256
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-58                                             [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-196                                         [1, 128, 256, 256]        [1, 128, 256, 256]        147,584                     0.03%                   [3, 3]                    9,672,065,024
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-197                                           [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-198                                         [1, 128, 256, 256]        [1, 128, 256, 256]        147,456                     0.03%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-199                                        [1, 256, 256, 128]        [1, 256, 256, 128]        256                         0.00%                   --                        256
â”‚    â”‚    â”‚    â””â”€ResBlock: 4-59                                             [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-200                                         [1, 128, 256, 256]        [1, 128, 256, 256]        147,584                     0.03%                   [3, 3]                    9,672,065,024
â”‚    â”‚    â”‚    â”‚    â””â”€SiLU: 5-201                                           [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Conv2d: 5-202                                         [1, 128, 256, 256]        [1, 128, 256, 256]        147,456                     0.03%                   [3, 3]                    9,663,676,416
â”‚    â”‚    â”‚    â”‚    â””â”€RMSNorm: 5-203                                        [1, 256, 256, 128]        [1, 256, 256, 128]        256                         0.00%                   --                        256
â”‚    â””â”€RMSNorm: 2-16                                                        [1, 256, 256, 128]        [1, 256, 256, 128]        256                         0.00%                   --                        256
â”‚    â””â”€ReLU: 2-17                                                           [1, 128, 256, 256]        [1, 128, 256, 256]        --                             --                   --                        --
â”‚    â””â”€Conv2d: 2-18                                                         [1, 128, 256, 256]        [1, 3, 256, 256]          3,459                       0.00%                   [3, 3]                    226,689,024
=================================================================================================================================================================================================================================
Total params: 472,577,475
Trainable params: 164,082,371
Non-trainable params: 308,495,104
Total mult-adds (G): 252.72
=================================================================================================================================================================================================================================
Input size (MB): 0.60
Forward/backward pass size (MB): 2408.42
Params size (MB): 1885.91
Estimated Total Size (MB): 4294.93
=================================================================================================================================================================================================================================
[32m[01/21 21:10:22 UniLIP]: [0mCreating optimizers.
Setting up discriminator optimizer
[32m[01/21 21:10:22 UniLIP]: [0mCreating lr_schedulers.
[32m[01/21 21:10:22 UniLIP]: [0mCreating dataloaders.
max train samples 1281167
self.train_transform: Compose(
    Resize(size=224, interpolation=bicubic, max_size=None, antialias=True)
    RandomCrop(size=(224, 224), padding=None)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
self.eval_transform: Compose(
    Resize(size=224, interpolation=bicubic, max_size=None, antialias=True)
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
[32m[01/21 21:10:22 UniLIP]: [0mCreating evaluator.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 91.2M/91.2M [00:03<00:00, 24.2MB/s]
Traceback (most recent call last):â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 89.5M/91.2M [00:03<00:00, 27.8MB/s]
[32m[01/21 21:10:28 UniLIP]: [0mPreparing model, optimizer and dataloaders
[32m[01/21 21:16:15 UniLIP]: [0m***** Running Stage 1 (Decoder Training) Training *****
[32m[01/21 21:16:15 UniLIP]: [0m  Num training steps = 100000
[32m[01/21 21:16:15 UniLIP]: [0m  Gradient Accumulation steps = 1
[32m[01/21 21:16:15 UniLIP]: [0m  Instantaneous batch size per gpu = 16
[32m[01/21 21:16:15 UniLIP]: [0m  Total train batch size (w. parallel, distributed & accumulation) = 32
[32m[01/21 21:16:15 UniLIP]: [0mAll globbed checkpoints are: []
[32m[01/21 21:16:15 UniLIP]: [0mTraining from scratch.
Epoch 0/2 started.
[32m[01/21 21:16:43 UniLIP]: [0mData (t): 0.0019, 61.47/s/gpu Batch (t): 0.2603 LR: 0.000002 Step: 50 Total Loss: 0.8312 Recon Loss: 0.0730
[32m[01/21 21:16:56 UniLIP]: [0mData (t): 0.0019, 61.23/s/gpu Batch (t): 0.2613 LR: 0.000003 Step: 100 Total Loss: 0.7945 Recon Loss: 0.0780
  File "/mnt/tidal-alsh01/dataset/zeus/lihongxiang/unified_model/my_unilip/tokenizer/scripts/train.py", line 174, in <module>
    main()
  File "/mnt/tidal-alsh01/dataset/zeus/lihongxiang/unified_model/my_unilip/tokenizer/scripts/train.py", line 147, in main
    global_step = train_one_epoch(config, logger, accelerator,
  File "/mnt/tidal-alsh01/dataset/zeus/lihongxiang/unified_model/my_unilip/tokenizer/utils/train_utils.py", line 371, in train_one_epoch
    optimizer.step()
  File "/root/miniconda3/envs/vgt/lib/python3.10/site-packages/accelerate/optimizer.py", line 146, in step
    if is_lomo_available():
  File "/root/miniconda3/envs/vgt/lib/python3.10/site-packages/accelerate/utils/imports.py", line 126, in is_lomo_available
    return _is_package_available("lomo_optim")
  File "/root/miniconda3/envs/vgt/lib/python3.10/site-packages/accelerate/utils/imports.py", line 52, in _is_package_available
    package_exists = importlib.util.find_spec(pkg_name) is not None
  File "/root/miniconda3/envs/vgt/lib/python3.10/importlib/util.py", line 103, in find_spec
    return _find_spec(fullname, parent_path)
  File "<frozen importlib._bootstrap>", line 945, in _find_spec
  File "<frozen importlib._bootstrap_external>", line 1439, in find_spec
  File "<frozen importlib._bootstrap_external>", line 1411, in _get_spec
  File "<frozen importlib._bootstrap_external>", line 1544, in find_spec
  File "<frozen importlib._bootstrap_external>", line 147, in _path_stat
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/mnt/tidal-alsh01/dataset/zeus/lihongxiang/unified_model/my_unilip/tokenizer/scripts/train.py", line 174, in <module>
[rank0]:     main()
[rank0]:   File "/mnt/tidal-alsh01/dataset/zeus/lihongxiang/unified_model/my_unilip/tokenizer/scripts/train.py", line 147, in main
[rank0]:     global_step = train_one_epoch(config, logger, accelerator,
[rank0]:   File "/mnt/tidal-alsh01/dataset/zeus/lihongxiang/unified_model/my_unilip/tokenizer/utils/train_utils.py", line 371, in train_one_epoch
[rank0]:     optimizer.step()
[rank0]:   File "/root/miniconda3/envs/vgt/lib/python3.10/site-packages/accelerate/optimizer.py", line 146, in step
[rank0]:     if is_lomo_available():
[rank0]:   File "/root/miniconda3/envs/vgt/lib/python3.10/site-packages/accelerate/utils/imports.py", line 126, in is_lomo_available
[rank0]:     return _is_package_available("lomo_optim")
[rank0]:   File "/root/miniconda3/envs/vgt/lib/python3.10/site-packages/accelerate/utils/imports.py", line 52, in _is_package_available
[rank0]:     package_exists = importlib.util.find_spec(pkg_name) is not None
[rank0]:   File "/root/miniconda3/envs/vgt/lib/python3.10/importlib/util.py", line 103, in find_spec
[rank0]:     return _find_spec(fullname, parent_path)
[rank0]:   File "<frozen importlib._bootstrap>", line 945, in _find_spec
[rank0]:   File "<frozen importlib._bootstrap_external>", line 1439, in find_spec
[rank0]:   File "<frozen importlib._bootstrap_external>", line 1411, in _get_spec
[rank0]:   File "<frozen importlib._bootstrap_external>", line 1544, in find_spec
[rank0]:   File "<frozen importlib._bootstrap_external>", line 147, in _path_stat
[rank0]: KeyboardInterrupt
