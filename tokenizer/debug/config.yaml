experiment:
  project: debug
  name: debug
  output_dir: debug
  max_train_examples: 1281167
  save_every: 5000
  eval_every: 5000
  generate_every: 1000
  log_every: 50
  log_grad_norm_every: 500
  resume: true
  init_weight: ''
model:
  name: DC_AE_ViT_Unified
  embed_dim: 32
  patch_size: 14
  mllm_path: /mnt/tidal-alsh01/dataset/zeus/lihongxiang/models/InternVL3-1B
  dc_ae_path: /mnt/tidal-alsh01/dataset/zeus/lihongxiang/models/dc-ae-f32c32-sana-1.1-diffusers
  stage1_ckpt: ''
  freeze_encoder: true
  output_distill_feat: false
  disable_drop_path: false
  use_gradient_checkpoint: false
  vq_model:
    quantize_mode: vae
losses:
  name: ReconstructionLoss_Unified
  discriminator_start: 30000
  quantizer_weight: 1.0
  discriminator_factor: 1.0
  discriminator_weight: 0.1
  perceptual_loss: lpips-convnext_s-1.0-0.1
  perceptual_weight: 1.1
  distill_loss: ''
  distill_weight: 0.0
  reconstruction_loss: l2
  reconstruction_weight: 1.0
  lecam_regularization_weight: 0.001
  kl_weight: 0.0
  logvar_init: 0.0
dataset:
  params:
    train_shards_path_or_url: /mnt/tidal-alsh01/dataset/zeus/lihongxiang/unified_model/VGT/tokenizer/data/dataset/train/imagenet-train-{000000..000320}.tar
    eval_shards_path_or_url: /mnt/tidal-alsh01/dataset/zeus/lihongxiang/unified_model/VGT/tokenizer/data/dataset/val/imagenet-val-{000000..000049}.tar
    num_workers_per_gpu: 12
    dataset_with_class_label: true
    dataset_with_text_label: false
  preprocessing:
    resize_shorter_edge: 224
    crop_size: 224
    random_crop: true
    random_flip: true
    normalize_mean:
    - 0.485
    - 0.456
    - 0.406
    normalize_std:
    - 0.229
    - 0.224
    - 0.225
    imagenet_norm: true
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    discriminator_learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.999
    weight_decay: 0.0001
    use_encoder_lr_scale: false
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 3000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 16
  mixed_precision: bf16
  enable_tf32: true
  enable_wandb: true
  wandb_api_key: 3ed65eb52edcc37a5e278a82dd874b44d4ffadb7
  ddp_find_unused_parameters: false
  use_ema: true
  seed: 42
  max_train_steps: 100000
  num_generated_images: 8
  max_grad_norm: 1.0
config: ./configs/training/InternVL3_1B_DCAE/internvl3_1B_unified_stage1_imagenet.yaml
